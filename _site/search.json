[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Welcome to Foo Lab / Dry Lab Computation",
    "section": "",
    "text": "For access to Foo-Lab network drive, please inform Mick Lee (mick.lee@u.nus.edu), or Erielle (emfv-09@nus.edu.sg) to add you into the Foo-Lab list of members / Administrators."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "This webpage is for the documentation of dry lab computation and softwares in NUS Foo-Lab @ CVRI\nVisit us at:\nFoo lab webpage : foo-lab.sg\ngithub website : https://github.com/Foo-Lab\nFor any further queries :\n\nFoo-Lab Manager:\nLouis Gan (louis.gan@nus.edu.sg)\nAdministrators:\nMick Lee (mick.lee@u.nus.edu)\nErielle (emfv-09@nus.edu.sg)\nNicholas Li (nyl12@nus.edu.sg)"
  },
  {
    "objectID": "rnaseq.html",
    "href": "rnaseq.html",
    "title": "Rnaseq pipeline",
    "section": "",
    "text": "This pipeline will take in paired-end FASTQ files, and produce gene count as output.\nThis is a general outline of the Bulk RNA-sequencing Analysis"
  },
  {
    "objectID": "rnaseq.html#trimming-of-adaptors-and-base-quality",
    "href": "rnaseq.html#trimming-of-adaptors-and-base-quality",
    "title": "Rnaseq pipeline",
    "section": "Trimming of adaptors and base quality",
    "text": "Trimming of adaptors and base quality\n$TRIM –fastqc –gzip –length 100 –paired $FASTQ_READ1 $FASTQ_READ2"
  },
  {
    "objectID": "rnaseq.html#star-alignment",
    "href": "rnaseq.html#star-alignment",
    "title": "Rnaseq pipeline",
    "section": "STAR alignment",
    "text": "STAR alignment\n$STAR –runThreadN $THREAD –genomeDir $STARIND –readFilesCommand zcat –outFileNamePrefix RNASEQ –outSAMtype BAM Unsorted –readFilesIn $TF1 $TF2 $STAR –runThreadN $THREAD –genomeDir $STARIND –sjdbFileChrStartEnd RNASEQSJ.out.tab –readFilesCommand zcat –outFileNamePrefix RNASEQ.2Pass –outSAMtype BAM Unsorted –readFilesIn $TF1 $TF2"
  },
  {
    "objectID": "rnaseq.html#sort-the-bam-files-by-name-and-count-by-htseq-count-for-edgerdeseq-analysis",
    "href": "rnaseq.html#sort-the-bam-files-by-name-and-count-by-htseq-count-for-edgerdeseq-analysis",
    "title": "Rnaseq pipeline",
    "section": "sort the bam files by name and count by htseq-count for EdgeR/DESeq analysis",
    "text": "sort the bam files by name and count by htseq-count for EdgeR/DESeq analysis\n$SAMTOOLS sort -n rnaseqtrimmedAligned.out.bam name_rnaseqtrimmedAligned.out $HTSEQCOUNT -f bam -r name -s no -m union name_rnaseqtrimmedAligned.out.bam $GTF &gt; count.txt ```"
  },
  {
    "objectID": "index.html#mounting-foo-lab-network-drive-in-nus-on-ubuntu-and-ubuntu-wsl-systems-using-cifs-utils-smb-protocol",
    "href": "index.html#mounting-foo-lab-network-drive-in-nus-on-ubuntu-and-ubuntu-wsl-systems-using-cifs-utils-smb-protocol",
    "title": "Welcome to Foo Lab / Dry Lab Computation",
    "section": "Mounting Foo-Lab Network drive in NUS on Ubuntu and Ubuntu WSL systems using CIFs utils / SMB protocol",
    "text": "Mounting Foo-Lab Network drive in NUS on Ubuntu and Ubuntu WSL systems using CIFs utils / SMB protocol\nInstall cifs-utils on ubuntu:\nsudo apt update\nsudo apt-get install cifs-utils\nCreate a mount point in your /mnt directory:\nsudo mkdir /mnt/uss-foolab\nCreate a credentials file - in /etc/cifs-credentials using vim or nano\nsudo vi /etc/cifs-credentials\n\nusername=NUSNETID\npassword=NUSNETPW\ndomain=nusstf\n\nAllow special permissions to cifs-credentials\n\nsudo chmod 600 /etc/cifs-credentials\n\nedit /etc/fstab file and add the following entry\n\n\nvi /etc/fstab\n\n//hpcnas.nus.edu.sg/uss-foolab /mnt/uss-foolab cifs credentials=/etc/cifs-credentials 0 0\n\nCreate folder to mount network volume in /mnt and mount all volume\n\nsudo mkdir /mnt/uss-foolab \nsudo mount -a \n\nOtherwise try using DrvFs wsl plugin protocol :\n\nsudo mount -t drvfs //hpcnas.nus.edu.sg/uss-foolab /mnt/uss-foolab -o username=NUSNETID\n````"
  },
  {
    "objectID": "index.html#getting-started",
    "href": "index.html#getting-started",
    "title": "Welcome to Foo Lab / Dry Lab Computation",
    "section": "",
    "text": "For access to Foo-Lab network drive, please inform Mick Lee (mick.lee@u.nus.edu), or Erielle (emfv-09@nus.edu.sg) to add you into the Foo-Lab list of members / Administrators."
  },
  {
    "objectID": "index.html#mounting-foo-lab-network-drive-in-nus-on-window-network-drive-system",
    "href": "index.html#mounting-foo-lab-network-drive-in-nus-on-window-network-drive-system",
    "title": "Welcome to Foo Lab / Dry Lab Computation",
    "section": "Mounting Foo-Lab Network drive in NUS on Window network drive system",
    "text": "Mounting Foo-Lab Network drive in NUS on Window network drive system\nHead over to your PC drive folder, and Add Network Locations (Right Click):\n\nSpecifiy the location of your website as the following:\n\nFoo-Lab network drive folder will be accessible under network drive :"
  },
  {
    "objectID": "rnaseq.html#part-1-detailed-description-of-the-basic-pipeline",
    "href": "rnaseq.html#part-1-detailed-description-of-the-basic-pipeline",
    "title": "Rnaseq pipeline",
    "section": "Part 1: Detailed Description of the basic pipeline",
    "text": "Part 1: Detailed Description of the basic pipeline\n\n1. Trimming of the reads before mapping\njava -jar trimmomatic-0.39.jar PE $F1 $F2 read1.fastq.gz read1.un.fastq.gz read2.fastq.gz read2.un.fastq.gz ILLUMINACLIP:illumina.fa:2:30:10 LEADING:28 TRAILING:28 SLIDINGWINDOW:4:28 MINLEN:100\nInput files:\na. F1 = FASTQ File Read 1  \nb. F2 = FASTQ File Read 2  \nThe details on various parameters can be found here.\nThis command trim the reads:\na. base quality\nb. adaptors / index\nRunning LOG:\nUsing Medium Clipping Sequence: 'AGATCGGAAGAGCACACGTCT'  \nUsing Medium Clipping Sequence: 'CTGTCTCTTATACACATCT'  \nUsing Long Clipping Sequence: 'CTGTCTCTTATACACATCT+AGATGTGTATAAGAGACAG'  \nUsing Long Clipping Sequence: 'AGATCGGAAGAGCACACGTCTGAACTCCAGTCA'  \nUsing Short Clipping Sequence: 'AGATCGGAAGAG'  \nUsing Long Clipping Sequence: 'AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGT'  \nUsing Long Clipping Sequence: 'AGATCGGAAGAGCACACGTCTGAAC'  \nUsing Long Clipping Sequence: 'AGATCGGAAGAGCGTCGTGTAGGGA'  \nUsing Medium Clipping Sequence: 'TGGAATTCTCGGGTGCCAAGG'  \nILLUMINACLIP: Using 0 prefix pairs, 9 forward/reverse sequences, 0 forward only sequences, 0 reverse only sequences  \nQuality encoding detected as phred33  \nInput Read Pairs: 57690695 Both Surviving: 40872736 (70.85%) Forward Only Surviving: 9407255 (16.31%) Reverse Only Surviving: 1621021 (2.81%) Dropped: 5789683 (10.04%)  \nTrimmomaticPE: Completed successfully  \n\n\n2. Mapping of sequencing reads\nstar --runThreadN $THREAD --outFileNamePrefix rnaseqtrimmed --outSAMtype BAM Unsorted --genomeDir $STARIND --readFilesCommand zcat --readFilesIn read1.fastq.gz read2.fastq.gz  \nInput files:\na. read1.fastq.gz (trimmed fastq file R1)  \nb. read2.fastq.gz (trimmed fastq file R2)  \nc. $STARIND = indices required for the mapping of sequencing reads.  \nThe details on various parameters can be found here.\nRunning LOG:\nMar 13 23:10:09 ..... started STAR run  \nMar 13 23:10:10 ..... loading genome  \nMar 13 23:11:59 ..... started mapping  \nMar 14 02:11:40 ..... finished successfully  \n\n\n3. Generation of RAW gene count using htseq-count\n/mnt/software/bin/htseq-count -f bam -r name -s no -m union name_rnaseqtrimmedAligned.out.bam $GTF &gt; count.txt  \nInput files:\na. BAM file (sorted by read name / position )  \nb. GTF files  \nOutput file (you need this for most analysis)\nFilename: count.txt (gene count needed for EdgeR / DESeq)  \nFormat:  \n&lt;Gene ID&gt; &lt;unnormalized count&gt;  \nExample:\nENSMUSG00000093369.1    0  \nENSMUSG00000093370.1    3  \nENSMUSG00000093371.1    15  \nENSMUSG00000093373.1    0  \nENSMUSG00000093374.1    0  \n__no_feature    9269724  \n__ambiguous 97362  \n__too_low_aQual 0  \n__not_aligned   0  \n__alignment_not_unique  3113139  \nDescription of the last 5 lines of each files:\n__no_feature: reads (or read pairs) which could not be assigned to any feature\n__ambiguous: reads (or read pairs) which could have been assigned to more than one feature\n__too_low_aQual: reads (or read pairs) which were skipped due to the -a option\n__not_aligned: reads (or read pairs) in the SAM file without alignment\n__alignment_not_unique: reads (or read pairs) with more than one reported alignment.\nRunning LOG:\n...  \n31700000 SAM alignment record pairs processed.  \n31800000 SAM alignment record pairs processed.  \n31900000 SAM alignment record pairs processed.  \n32000000 SAM alignment record pairs processed.  \n32100000 SAM alignment record pairs processed.  \n32200000 SAM alignment record pairs processed.  \n32300000 SAM alignment record pairs processed.  \n32400000 SAM alignment record pairs processed.  \n32500000 SAM alignment record pairs processed.  \n32600000 SAM alignment record pairs processed.  \n32700000 SAM alignment record pairs processed.  \n32800000 SAM alignment record pairs processed.  \n32889607 SAM alignment pairs processed."
  },
  {
    "objectID": "rnaseq.html#part-2-running-differential-expression-analysis-using-edger-package-using-mouse-sham-vs-tac-rna-seq-as-example",
    "href": "rnaseq.html#part-2-running-differential-expression-analysis-using-edger-package-using-mouse-sham-vs-tac-rna-seq-as-example",
    "title": "Rnaseq pipeline",
    "section": "Part 2 Running Differential Expression analysis using edgeR package (using Mouse Sham vs TAC RNA-seq as example)",
    "text": "Part 2 Running Differential Expression analysis using edgeR package (using Mouse Sham vs TAC RNA-seq as example)\nThe differential analysis starts here:\nRscript-3.5.1 edgeR.r &lt;control group&gt; &lt; treatment group&gt;  \n\nInput\nInput file: countfile.txt (hard-coded for now)\nThis file is a tab-delimited text file with 3 columns. Header is optional.\n| Column | Description | | ——– | ———– | | Column 1 | full path to the count file generated by htseq-count | | Column 2 | sample id | | Column 3 | condition/grouping information used for DE analysis |\nExample countfile.txt:\n| countfile | sampleid | group | | — | — | — | | RMH3869_count.txt | RMH3869 | TAC | | RMH3871_count.txt | RMH3871 | SHAM | | RMH3872_count.txt | RMH3872 | TAC | | RMH3874_count.txt | RMH3874 | SHAM | | RMH3875_count.txt | RMH3875 | TAC | | RMH3877_count.txt | RMH3877 | SHAM |\n\n\nCommand\nI usualy run my R script on linux command line. You can also modify the script to make it work on Rstudio or any IDE.\nThe command line will require two user arguments for this particular script. These arguments are the sample groupings. In my case, it will be SHAM and TAC.\nI am using R version 3.5.1.\nRscript-3.5.1 single_edgeR.r SHAM TAC\n\n\n\nR script (You can copy this into your RStudio if you are not running on linux like me. Dont use single_edgeR.r in that case.)\nThis is the skeleton of generic edgeR analysis. You can start with this script first and slowly add/edit according to your experimental designs.\nfilelist = read.table(\"countfile.txt\")\nnames(filelist)=c(\"filename\",\"sample\",\"group\")\ngene2biotype = read.table(\"/mnt/projects/wlwtan/cardiac_epigenetics/pipeline/rnaseq_pipeline/resource/mm9/mm9_gene2biotype.txt\")  \nnames(gene2biotype)=c(\"id\",\"hgnc\",\"biotype\")  \ndata = readDGE(file=filelist$filename,group=filelist$group,labels=filelist$sample)  \ndesign = model.matrix(~0+filelist$group)  \nfilter = apply(data$counts,1,function(x) length(x[x&gt;5])&gt;=2)\nfiltered = data$counts[ filter, ]\ny = DGEList(counts = as.matrix(filtered), group=filelist$group )  \ny = calcNormFactors(y)  \ny = estimateDisp(y, design)  \nfit = glmFit(y,design)\nlrt21 = glmLRT(fit,contrast=c(-1,1))  \nk21 = as.data.frame(topTags(lrt21,n=10000000))  \nk21$hgnc = gene2biotype$hgnc[match(rownames(k21),gene2biotype$id)]  \nk21$biotype = gene2biotype$biotype[match(rownames(k21),gene2biotype$id)]  \nwrite.table(k21,file=\"de_SHAM_TAC.txt\",sep=\"\\t\",quote=FALSE)  \n\n\n\nOutput of single_edgeR.r\nThe R script will generate a few output files.\n\nde_SHAM_TAC.txt\nThis is the output of differential gene expression test performed by edgeR. Although there is no definite cut-off to define significance, I use abs(log2FC)&gt;0.5, FDR&lt;0.05 and avg FPKM&gt;1 as a cut-off for significant DEGs. The columns are:\n\n\n\n\nColumn\nDescription\n\n\n\n\n1\nGENCODE Gene ID\n\n\n2\nlog2FC (Group2/Group1)\n\n\n3\nlogCPM across the samples\n\n\n4\nTest statistics (loglikelihodd)\n\n\n5\nP-value\n\n\n6\nFDR\n\n\n7\nGene Symbol / HGNC\n\n\n8\nBiotype\n\n\n9-whatever\nFPKM of all samples\n\n\n\n\nScatterplot (scatterplot_withtext_SHAM_TAC.png)\nOne of the plots that we can look at is scatterplot that represents the correlation between the two conditions (SHAM and TAC). The x-axis in the graph below shows average FPKM of SHAM cardiomyocytes and the y-axis shows average FPKM of TAC cardiomyocytes.\nUnsupervised clustering based on DEGs\n\nPCA analysis based on DEGs"
  },
  {
    "objectID": "rnaseq.html#part-3-pathway-enrichment-analysis",
    "href": "rnaseq.html#part-3-pathway-enrichment-analysis",
    "title": "Rnaseq pipeline",
    "section": "Part 3: Pathway Enrichment Analysis",
    "text": "Part 3: Pathway Enrichment Analysis\n\n1. Gene-set Enrichment Analysis (GSEA)\nRscript-3.5.1 fgsea.r de_SHAM_TAC.txt\nThe analysis was done by using FGSEA R package.\nGSEA analysis takes the logFC / test statistics / pvalue from all the genes in the dataset, and try to find the pathways which are differentially expressed collectively.\nUpregulated Pathways:\n\n\n\n\n\n\n\n\n\n\npathway\npval\npadj\nES\nNES\n\n\n\n\nGO_COLLAGEN_TRIMER\n0\n0.0079\n0.8466\n2.682\n\n\nGO_EXTRACELLULAR_MATRIX_COMPONENT\n0\n0.0079\n0.7538\n2.6497\n\n\nGO_PROTEINACEOUS_EXTRACELLULAR_MATRIX\n0\n0.0079\n0.7161\n2.6478\n\n\nGO_EXTRACELLULAR_STRUCTURE_ORGANIZATION\n0\n0.0079\n0.7128\n2.6383\n\n\nGO_EXTRACELLULAR_MATRIX_BINDING\n0\n0.0079\n0.8044\n2.6162\n\n\nGO_EXTRACELLULAR_MATRIX_STRUCTURAL_CONSTITUENT\n0\n0.0079\n0.8255\n2.6064\n\n\nGO_EXTRACELLULAR_MATRIX\n0\n0.0079\n0.6939\n2.6011\n\n\nGO_BASEMENT_MEMBRANE\n0\n0.0079\n0.7501\n2.5799\n\n\nGO_COLLAGEN_BINDING\n0\n0.0079\n0.7807\n2.564\n\n\n\nDownregulated Pathways:\n\n\n\n\n\n\n\n\n\n\npathway\npval\npadj\nES\nNES\n\n\n\n\nGO_MITOCHONDRIAL_ATP_SYNTHESIS_COUPLED_PROTON_TRANSPORT\n0\n0.0143\n-0.7478\n-2.3421\n\n\nGO_PROTON_TRANSPORTING_ATP_SYNTHASE_COMPLEX\n0\n0.0148\n-0.6904\n-2.2669\n\n\nGO_BRANCHED_CHAIN_AMINO_ACID_METABOLIC_PROCESS\n0\n0.0148\n-0.6333\n-2.0795\n\n\nGO_PHOTORECEPTOR_CELL_MAINTENANCE\n0\n0.016\n-0.5669\n-1.9882\n\n\nGO_MALE_MEIOSIS\n0\n0.016\n-0.5459\n-1.9145\n\n\nGO_NADH_DEHYDROGENASE_ACTIVITY\n0\n0.0172\n-0.6156\n-2.2153\n\n\nGO_MITOCHONDRIAL_ELECTRON_TRANSPORT_NADH_TO_UBIQUINONE\n0\n0.0179\n-0.6089\n-2.2264\n\n\nGO_NADH_DEHYDROGENASE_COMPLEX\n0\n0.0179\n-0.5823\n-2.1291\n\n\nGO_FATTY_ACID_BETA_OXIDATION\n0\n0.0183\n-0.4836\n-1.8241\n\n\n\n \n\n\n2. Over-representation Analysis (Enrichment-based) Pathway analysis\nRscript-3.5.1 goseq.r de_SHAM_TAC.txt  \nThe list of differentially expressed genes will be supplied to check for enrichment in a specific geneset or pathway or ontology. The package used here is GOseq. Alternatively, there are also a couple of online free tools that you can use such as David / Enrichr.\nOntology terms enriched in up-regulated genes:\n\n\n\n\n\n\n\n\n\n\n\ncategory\nover_represented_pvalue\nnumDEInCat\nnumInCat\nterm\nontology\n\n\n\n\nGO_0030198\n1.59289631513099e-29\n58\n165\nextracellular matrix organization\nBP\n\n\nGO_0043062\n7.25401577545077e-28\n61\n198\nextracellular structure organization\nBP\n\n\nGO_0007155\n7.52728027032633e-28\n130\n786\ncell adhesion\nBP\n\n\nGO_0022610\n1.89458381420028e-27\n130\n794\nbiological adhesion\nBP\n\n\nGO_0009653\n1.3895959294514e-21\n202\n1808\nanatomical structure morphogenesis\nBP\n\n\nGO_0016477\n4.586619274943e-19\n127\n959\ncell migration\nBP\n\n\nGO_0001525\n4.8894400795615e-19\n72\n391\nangiogenesis\nBP\n\n\nGO_0035295\n5.83669120066987e-19\n112\n791\ntube development\nBP\n\n\nGO_0035239\n9.56339723145197e-19\n99\n657\ntube morphogenesis\nBP\n\n\nGO_0048870\n1.80505175084392e-18\n130\n1017\ncell motility\nBP\n\n\n\nOntology terms enriched in down-regulated genes:\n\n\n\n\n\n\n\n\n\n\n\ncategory\nover_represented_pvalue\nnumDEInCat\nnumInCat\nterm\nontology\n\n\n\n\nGO_0044281\n3.98227858592603e-08\n71\n1325\nsmall molecule metabolic process\nBP\n\n\nGO_0006635\n3.60003697030415e-07\n11\n58\nfatty acid beta-oxidation\nBP\n\n\nGO_0016054\n9.25408023716837e-07\n17\n154\norganic acid catabolic process\nBP\n\n\nGO_0046395\n9.25408023716837e-07\n17\n154\ncarboxylic acid catabolic process\nBP\n\n\nGO_0009062\n1.15898676473624e-06\n12\n78\nfatty acid catabolic process\nBP\n\n\nGO_0008016\n1.25401426261223e-06\n16\n137\nregulation of heart contraction\nBP\n\n\nGO_0043436\n2.97533226290676e-06\n40\n668\noxoacid metabolic process\nBP\n\n\nGO_0006082\n3.93851000867858e-06\n40\n676\norganic acid metabolic process\nBP\n\n\nGO_0044242\n4.12629854308222e-06\n15\n136\ncellular lipid catabolic process\nBP\n\n\nGO_0072329\n4.19219279151121e-06\n12\n88\nmonocarboxylic acid catabolic process\nBP"
  }
]